<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>現在日時表示</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Tailwind CSS custom configuration
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'], // Use Inter font
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: transparent; /* For transparent background in OBS */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden; /* Hide scrollbars */
            font-family: 'Inter', sans-serif; /* Apply Inter font */
        }
        /* Main container shadow and rounded corners */
        #main-container {
            border-radius: 1rem; /* rounded-2xl */
            padding: 0.75rem; /* Reduced overall padding */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); /* shadow-lg */
            display: flex;
            flex-direction: column;
            width: fit-content; /* Reverted to fit-content */
            /* background-color will be set by JS */
        }

        /* Wrapper for date display to handle alignment */
        #date-display-wrapper,
        #time-display-wrapper {
            width: 100%; /* Occupy full width of parent for alignment */
            display: flex; /* Use flexbox for reliable alignment */
            /* justify-content will be set by JS */
        }

        /* Date display area */
        #date-display {
            border-radius: 0.5rem; /* rounded-lg */
            padding: 0.3rem 0.7rem; /* Adjusted padding for better balance */
            margin-bottom: 0.2rem; /* Adjusted spacing */
            font-size: 0.85em; /* Adjusted font size for better balance */
            font-weight: bold; /* font-bold */
            white-space: nowrap; /* Prevent text wrapping */
            /* background-color and color will be set by JS */
            width: fit-content; /* Keep fit-content for background to be near text */
            /* display: inline-block is no longer needed with flex parent */
            line-height: 1.2; /* Adjust line height for better vertical alignment */
        }
        /* Time display area */
        #time-display {
            border-radius: 0.5rem; /* rounded-lg */
            padding: 0.5rem 1rem; /* Adjusted padding for better balance */
            font-size: 3.5em; /* Adjusted to design */
            font-weight: bold; /* font-bold */
            white-space: nowrap; /* Prevent text wrapping */
            /* background-color and color will be set by JS */
            width: fit-content; /* Keep fit-content for background to be near text */
            /* display: inline-block is no longer needed with flex parent */
            line-height: 1.2; /* Adjust line height for better vertical alignment */
        }
    </style>
</head>
<body>
    <div id="main-container">
        <div id="date-display-wrapper">
            <div id="date-display"></div>
        </div>
        <div id="time-display-wrapper">
            <div id="time-display"></div>
        </div>
    </div>

    <script>
        /**
         * Parses URL parameters and returns them as an object.
         * @returns {Object} An object containing URL parameters.
         */
        function getUrlParams() {
            const params = {};
            window.location.search.substring(1).split('&').forEach(param => {
                const [key, value] = param.split('=');
                if (key && value) {
                    params[key] = decodeURIComponent(value);
                }
            });
            return params;
        }

        /**
         * Converts a hex color string (e.g., "RRGGBB") to a CSS color string (e.g., "#RRGGBB").
         * If the input is not a 6-digit hex, it returns the input as is (assuming it's a CSS color name).
         * @param {string} color - The color string.
         * @returns {string} The formatted CSS color string.
         */
        function formatColor(color) {
            if (color && color.match(/^[0-9A-Fa-f]{6}$/)) {
                return `#${color}`;
            }
            return color;
        }

        /**
         * Updates the current date and time display.
         */
        function updateDateTime() {
            const now = new Date();

            // Date format (e.g., 6/3 (Tue))
            const dateOptions = {
                month: 'numeric',
                day: 'numeric',
                weekday: 'short' // Display abbreviated weekday
            };
            const dateFormatter = new Intl.DateTimeFormat(navigator.language, dateOptions);
            const formattedDate = dateFormatter.format(now);

            // Get timezone abbreviation
            const timeZoneOptions = {
                timeZoneName: 'short'
            };
            const timeZoneFormatter = new Intl.DateTimeFormat(navigator.language, timeZoneOptions);
            const timeZoneParts = timeZoneFormatter.formatToParts(now);
            let timeZoneAbbr = '';
            for (const part of timeZoneParts) {
                if (part.type === 'timeZoneName') {
                    timeZoneAbbr = part.value;
                    break;
                }
            }

            // Time format (例: 13:24)
            const timeOptions = {
                hour: '2-digit',
                minute: '2-digit',
                hourCycle: 'h23' // 24-hour display
            };
            const timeFormatter = new Intl.DateTimeFormat(navigator.language, timeOptions);
            const formattedTime = timeFormatter.format(now);

            // Combine and display date and timezone
            document.getElementById('date-display').textContent = `${formattedDate} (${timeZoneAbbr})`;
            document.getElementById('time-display').textContent = formattedTime;
        }

        // Event listener for DOM content loaded
        document.addEventListener('DOMContentLoaded', () => {
            const params = getUrlParams();

            const body = document.body;
            const mainContainer = document.getElementById('main-container');
            const dateDisplay = document.getElementById('date-display');
            const timeDisplay = document.getElementById('time-display');
            const dateDisplayWrapper = document.getElementById('date-display-wrapper');
            const timeDisplayWrapper = document.getElementById('time-display-wrapper');

            // Apply background color to body
            body.style.backgroundColor = formatColor(params.bgColor || 'transparent');

            // Apply background color to main container
            mainContainer.style.backgroundColor = formatColor(params.containerBgColor || '#FFFFFF');

            // Apply colors to date display
            dateDisplay.style.backgroundColor = formatColor(params.dateBgColor || '#E2BEE6');
            dateDisplay.style.color = formatColor(params.dateTextColor || '#6D2A84');

            // Apply colors to time display
            timeDisplay.style.backgroundColor = formatColor(params.timeBgColor || '#CD93D7');
            timeDisplay.style.color = formatColor(params.timeTextColor || '#48148A');

            // Determine justify-content value based on dateAlign parameter
            const dateAlignment = params.dateAlign || 'left'; // Default to 'left'
            let dateJustifyValue;
            switch (dateAlignment) {
                case 'left':
                    dateJustifyValue = 'flex-start';
                    break;
                case 'right':
                    dateJustifyValue = 'flex-end';
                    break;
                case 'center':
                default:
                    dateJustifyValue = 'center';
                    break;
            }
            dateDisplayWrapper.style.justifyContent = dateJustifyValue;

            // Default time alignment to center as timeAlign parameter is removed
            timeDisplayWrapper.style.justifyContent = 'center';

            // Apply font sizes if provided
            if (params.dateFontSize) {
                dateDisplay.style.fontSize = params.dateFontSize;
            }
            if (params.timeFontSize) {
                timeDisplay.style.fontSize = params.timeFontSize;
            }

            // Apply overall scale if provided
            if (params.scale) {
                mainContainer.style.transform = `scale(${params.scale})`;
                mainContainer.style.transformOrigin = 'center center'; // Scale from the center
            }
        });

        // Update every second
        setInterval(updateDateTime, 1000);

        // Display once on page load
        updateDateTime();
    </script>
</body>
</html>
